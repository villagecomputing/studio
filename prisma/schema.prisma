generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Dataset {
  uuid           String           @id
  name           String
  created_at     DateTime         @default(now())
  deleted_at     DateTime?
  updated_at     DateTime         @updatedAt
  Dataset_column Dataset_column[]
  Experiment     Experiment[]
}

model Dataset_column {
  id                Int                 @id @default(autoincrement())
  dataset_uuid      String
  name              String
  field             String
  index             Int
  type              String
  created_at        DateTime            @default(now())
  updated_at        DateTime            @updatedAt
  deleted_at        DateTime?
  Dataset           Dataset             @relation(fields: [dataset_uuid], references: [uuid], onDelete: Cascade)
  Experiment_column Experiment_column[]
}

model Experiment_column {
  id                     Int             @id @default(autoincrement())
  experiment_uuid        String
  name                   String
  field                  String
  type                   String
  ground_truth_column_id Int?
  created_at             DateTime        @default(now())
  updated_at             DateTime        @updatedAt
  deleted_at             DateTime?
  Dataset_column         Dataset_column? @relation(fields: [ground_truth_column_id], references: [id])
  Experiment             Experiment      @relation(fields: [experiment_uuid], references: [uuid], onDelete: Cascade)
}

model Experiment_group {
  id         Int          @id @default(autoincrement())
  created_at DateTime     @default(now())
  Experiment Experiment[]
}

model Experiment {
  uuid              String              @id
  name              String
  description       String?
  dataset_uuid      String
  group_id          Int
  pipeline_metadata String
  created_at        DateTime            @default(now())
  updated_at        DateTime            @updatedAt
  deleted_at        DateTime?
  total_latency     Float               @default(0)
  latency_p50       Float               @default(0)
  latency_p90       Float               @default(0)
  total_cost        Float               @default(0)
  total_accuracy    Float               @default(0)
  total_rows        Float               @default(0)
  Experiment_group  Experiment_group    @relation(fields: [group_id], references: [id], onDelete: Cascade)
  Dataset           Dataset             @relation(fields: [dataset_uuid], references: [uuid], onDelete: Cascade)
  Experiment_column Experiment_column[]
}
